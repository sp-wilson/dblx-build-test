(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["HTML5"],{

/***/ "./themes/mcg/assets/src/js/main/video/Video.ts":
/*!******************************************************!*\
  !*** ./themes/mcg/assets/src/js/main/video/Video.ts ***!
  \******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils */ \"./themes/mcg/assets/src/js/utils/index.ts\");\n/* harmony import */ var _utils_observer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/observer */ \"./themes/mcg/assets/src/js/utils/observer.ts\");\n\n\n\n\n/**\n * This is video base class.\n */\nclass Video {\n  constructor(element) {\n    Object(_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, \"element\", void 0);\n\n    Object(_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, \"container\", void 0);\n\n    Object(_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, \"id\", void 0);\n\n    Object(_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, \"isPlaying\", void 0);\n\n    Object(_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, \"isReady\", void 0);\n\n    Object(_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, \"queue\", void 0);\n\n    Object(_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, \"player\", void 0);\n\n    Object(_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, \"playPromise\", void 0);\n\n    this.element = element;\n    this.container = Object(_utils__WEBPACK_IMPORTED_MODULE_1__[\"get\"])(\".js-video-container\", element);\n    this.id = element.getAttribute(\"data-id\") || \"\";\n    this.isPlaying = false;\n    this.isReady = false;\n    this.queue = new Set();\n    this.createPlayer();\n\n    this._observeElement();\n\n    element.dispatchEvent(new CustomEvent(\"videoloaded\"));\n  }\n\n  play() {\n    if (this.isPlaying) return;\n\n    if (!this.isReady) {\n      this.createPlayer();\n\n      this._queueTask(\"play\");\n\n      return;\n    }\n\n    this.playPromise = Promise.resolve(this.playVideo());\n  }\n\n  async pause() {\n    if (!this.isPlaying) return;\n\n    if (!this.isReady || typeof this.playPromise === \"undefined\") {\n      this._queueTask(\"pause\");\n\n      return;\n    }\n\n    await this.playPromise;\n    this.pauseVideo();\n    this.onStop();\n  }\n\n  onEnded() {\n    this.onStop();\n  }\n\n  onPlay() {\n    this.element.setAttribute(\"data-status\", \"loaded playing\");\n    this.isPlaying = true;\n  }\n\n  onStop() {\n    this.element.setAttribute(\"data-status\", \"loaded paused\");\n    this.isPlaying = false;\n  }\n\n  watchResize(videoWidth, videoHeight) {\n    const aspectRatio = videoHeight / videoWidth;\n\n    const updateSize = () => {\n      const containerWidth = this.element.clientWidth;\n      this.container.style.width = `${containerWidth}px`;\n      this.container.style.height = `${containerWidth * aspectRatio}px`;\n    };\n\n    updateSize();\n    this.element.dispatchEvent(new CustomEvent(\"videosize\"));\n    window.dispatchEvent(new CustomEvent(\"resize\"));\n    window.addEventListener(\"resize\", () => updateSize());\n    this.player.element.setAttribute(\"tabindex\", \"-1\");\n  }\n\n  flushQueue() {\n    this.queue.forEach(command => this[command]());\n    this.queue.clear();\n  }\n\n  _queueTask(command) {\n    this.queue.add(command);\n  }\n\n  _observeElement() {\n    Object(_utils_observer__WEBPACK_IMPORTED_MODULE_2__[\"observe\"])(this.container, inView => {\n      if (inView) {\n        this.play();\n      } else if (this.isReady) {\n        this.pause();\n      }\n    }, {\n      threshold: 0.25,\n      rootMargin: \"-50px\"\n    });\n  }\n\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Video);\n\n//# sourceURL=webpack:///./themes/mcg/assets/src/js/main/video/Video.ts?");

/***/ }),

/***/ "./themes/mcg/assets/src/js/main/video/types/HTML5.ts":
/*!************************************************************!*\
  !*** ./themes/mcg/assets/src/js/main/video/types/HTML5.ts ***!
  \************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _Video__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Video */ \"./themes/mcg/assets/src/js/main/video/Video.ts\");\n\n\n/* eslint-disable camelcase */\n\n\nclass HTML5Video extends _Video__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\n  constructor(...args) {\n    super(...args);\n\n    Object(_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, \"player\", void 0);\n  }\n\n  createPlayer() {\n    if (this.player) return;\n    const {\n      sources\n    } = JSON.parse(this.container.getAttribute(\"data-sources\"));\n    this.container.innerHTML = `\n            <video muted playsinline autoplay loop>\n                ${sources.reduce((acc, curr) => {\n      // eslint-disable-next-line no-param-reassign\n      acc += `<source src=\"${curr.url}\" type=\"${curr.mime_type}\" width=\"${curr.width}\" height=\"${curr.height}\">`;\n      return acc;\n    }, \"\")}\n            </video>\n        `; // @ts-expect-error\n\n    this.player = this.container.firstElementChild; // @ts-expect-error\n\n    this.player.element = this.container.firstElementChild;\n    this.player.addEventListener(\"canplay\", () => this._onReady());\n    this.player.addEventListener(\"ended\", () => this.onEnded());\n    this.player.addEventListener(\"play\", () => this.onPlay());\n    this.player.addEventListener(\"pause\", () => this.pause());\n  }\n\n  playVideo() {\n    this.player.play();\n  }\n\n  pauseVideo() {\n    this.player.pause();\n  }\n\n  _onReady() {\n    this.isReady = true;\n    const {\n      videoWidth,\n      videoHeight\n    } = this.player;\n    this.watchResize(videoWidth, videoHeight);\n    \"requestIdleCallback\" in window ? // @ts-ignore\n    requestIdleCallback(() => this.flushQueue()) : this.flushQueue();\n  }\n\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (HTML5Video);\n\n//# sourceURL=webpack:///./themes/mcg/assets/src/js/main/video/types/HTML5.ts?");

/***/ })

}]);